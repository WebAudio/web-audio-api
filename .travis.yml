language: cpp
sudo: false
script:
  # run bikeshed and save the error output.  
  - curl https://api.csswg.org/bikeshed/ -F file=@index.bs -F force=1 -F output=err -o err
  # Compare against our expected results. The sed command removes
  # the ANSI color codes from the output to make it easier to read.
  # If expected-errs.txt ever needs to be updated, run the following
  # commands, but save the output from sed to expected-errs.txt and
  # check in the file.
  - cat err | sed -E 's/\\033\[([0-9]{1,2}(;[0-9]{1,2})?)?[m|K]//g' | diff -u - expected-errs.txt

branches:
  only:
    - gh-pages
